<main>
  <h2>Register</h2>
<form id="register-form">
  <label>Username:</label>
  <input type="text" id="reg-username" name="username" required><br><br>

  <label>Password:</label>
  <input type="password" id="reg-password" name="password" required><br><br>

  <label>First Name:</label>
  <input type="text" id="reg-firstname" name="firstname" required><br><br>

  <label>Last Name:</label>
  <input type="text" id="reg-lastname" name="lastname" required><br><br>

  <label>Age:</label>
  <input type="number" id="reg-age" name="age"><br><br>

  <label>Salary:</label>
  <input type="number" id="reg-salary" name="salary" step="0.01"><br><br>

  <button type="submit">Register</button>
</form>

  <h2>Login</h2>
  <form id="login-form">
    <label>Username:</label>
    <input type="text" id="login-username" name="username" required>
    <br><br>
    <label>Password:</label>
    <input type="password" id="login-password" name="password" required>
    <br><br>
    <button type="submit">Login</button>
  </form>

  <script>
    // Registration handler
const regForm = document.getElementById('register-form');
regForm.addEventListener('submit', async (e) => {
  e.preventDefault();
  const username = regForm.username.value;
  const password = regForm.password.value;
  const firstname = regForm.firstname.value;
  const lastname = regForm.lastname.value;
  const age = regForm.age.value;
  const salary = regForm.salary.value;

  if (!username || !password) {
    alert("Username and password are required");
    return;
  }

  try {
    const response = await fetch("http://localhost:5050/register", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password, firstname, lastname, age, salary })
    });

    const data = await response.json();
    if (data.success === true) {
      alert("Registration successful! Please log in.");
      regForm.reset();
    } else {
      alert("Registration failed: " + (data.error || "Unknown error"));
    }
  } catch (err) {
    console.error(err);
    alert("Error connecting to server");
  }
});

    // Login handler
    const loginForm = document.getElementById('login-form');
    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const username = loginForm.username.value;
      const password = loginForm.password.value;

      if (!username || !password) {
        alert("Username and password are required");
        return;
      }

      try {
        const response = await fetch("http://localhost:5050/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username, password })
        });

        const data = await response.json();
        console.log("Login response:", data);

        if (data.success === true || data.success === "true") {
          alert("Login successful!");
          window.location.assign("./names.html");
        } else {
          alert("Login failed: " + (data.message || "Unknown error"));
        }
      } catch (err) {
        console.error(err);
        alert("Error connecting to server");
      }
    });
  </script>  
</main>
